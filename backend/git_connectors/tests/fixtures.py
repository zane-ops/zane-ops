import hashlib
import hmac
import json
import re
import responses
from rest_framework import status


def get_github_signed_event_headers(event: str, payload_body: dict, secret: str):
    hash_object = hmac.new(
        secret.encode("utf-8"),
        msg=json.dumps(payload_body).encode("utf-8"),
        digestmod=hashlib.sha256,
    )
    return {
        "X-GitHub-Event": event,
        "X-Hub-Signature-256": "sha256=" + hash_object.hexdigest(),
    }


# ==============================
# .      GITHUB WEBHOOKS       #
# ==============================

GITHUB_APP_MANIFEST_DATA = {
    "id": 1,
    "slug": "octoapp",
    "node_id": "MDxOkludGVncmF0aW9uMQ==",
    "owner": {
        "login": "github",
        "id": 1,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjE=",
        "url": "https://api.github.com/orgs/github",
        "repos_url": "https://api.github.com/orgs/github/repos",
        "events_url": "https://api.github.com/orgs/github/events",
        "avatar_url": "https://github.com/images/error/octocat_happy.gif",
        "gravatar_id": "",
        "html_url": "https://github.com/octocat",
        "followers_url": "https://api.github.com/users/octocat/followers",
        "following_url": "https://api.github.com/users/octocat/following{/other_user}",
        "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
        "organizations_url": "https://api.github.com/users/octocat/orgs",
        "received_events_url": "https://api.github.com/users/octocat/received_events",
        "type": "User",
        "site_admin": True,
    },
    "name": "Octocat App",
    "description": "",
    "external_url": "https://example.com",
    "html_url": "https://github.com/apps/octoapp",
    "created_at": "2017-07-08T16:18:44-04:00",
    "updated_at": "2017-07-08T16:18:44-04:00",
    "permissions": {
        "metadata": "read",
        "contents": "read",
        "issues": "write",
        "single_file": "write",
    },
    "events": ["push", "pull_request"],
    "client_id": "Iv1.8a61f9b3a7aba766",
    "client_secret": "1726be1638095a19edd134c77bde3aa2ece1e5d8",
    "webhook_secret": "e340154128314309424b7c8e90325147d99fdafa",
    "pem": "-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAuEPzOUE+kiEH1WLiMeBytTEF856j0hOVcSUSUkZxKvqczkWM\n9vo1gDyC7ZXhdH9fKh32aapba3RSsp4ke+giSmYTk2mGR538ShSDxh0OgpJmjiKP\nX0Bj4j5sFqfXuCtl9SkH4iueivv4R53ktqM+n6hk98l6hRwC39GVIblAh2lEM4L/\n6WvYwuQXPMM5OG2Ryh2tDZ1WS5RKfgq+9ksNJ5Q9UtqtqHkO+E63N5OK9sbzpUUm\noNaOl3udTlZD3A8iqwMPVxH4SxgATBPAc+bmjk6BMJ0qIzDcVGTrqrzUiywCTLma\nszdk8GjzXtPDmuBgNn+o6s02qVGpyydgEuqmTQIDAQABAoIBACL6AvkjQVVLn8kJ\ndBYznJJ4M8ECo+YEgaFwgAHODT0zRQCCgzd+Vxl4YwHmKV2Lr+y2s0drZt8GvYva\nKOK8NYYZyi15IlwFyRXmvvykF1UBpSXluYFDH7KaVroWMgRreHcIys5LqVSIb6Bo\ngDmK0yBLPp8qR29s2b7ScZRtLaqGJiX+j55rNzrZwxHkxFHyG9OG+u9IsBElcKCP\nkYCVE8ZdYexfnKOZbgn2kZB9qu0T/Mdvki8yk3I2bI6xYO24oQmhnT36qnqWoCBX\nNuCNsBQgpYZeZET8mEAUmo9d+ABmIHIvSs005agK8xRaP4+6jYgy6WwoejJRF5yd\nNBuF7aECgYEA50nZ4FiZYV0vcJDxFYeY3kYOvVuKn8OyW+2rg7JIQTremIjv8FkE\nZnwuF9ZRxgqLxUIfKKfzp/5l5LrycNoj2YKfHKnRejxRWXqG+ZETfxxlmlRns0QG\nJ4+BYL0CoanDSeA4fuyn4Bv7cy/03TDhfg/Uq0Aeg+hhcPE/vx3ebPsCgYEAy/Pv\neDLssOSdeyIxf0Brtocg6aPXIVaLdus+bXmLg77rJIFytAZmTTW8SkkSczWtucI3\nFI1I6sei/8FdPzAl62/JDdlf7Wd9K7JIotY4TzT7Tm7QU7xpfLLYIP1bOFjN81rk\n77oOD4LsXcosB/U6s1blPJMZ6AlO2EKs10UuR1cCgYBipzuJ2ADEaOz9RLWwi0AH\nPza2Sj+c2epQD9ZivD7Zo/Sid3ZwvGeGF13JyR7kLEdmAkgsHUdu1rI7mAolXMaB\n1pdrsHureeLxGbRM6za3tzMXWv1Il7FQWoPC8ZwXvMOR1VQDv4nzq7vbbA8z8c+c\n57+8tALQHOTDOgQIzwK61QKBgERGVc0EJy4Uag+VY8J4m1ZQKBluqo7TfP6DQ7O8\nM5MX73maB/7yAX8pVO39RjrhJlYACRZNMbK+v/ckEQYdJSSKmGCVe0JrGYDuPtic\nI9+IGfSorf7KHPoMmMN6bPYQ7Gjh7a++tgRFTMEc8956Hnt4xGahy9NcglNtBpVN\n6G8jAoGBAMCh028pdzJa/xeBHLLaVB2sc0Fe7993WlsPmnVE779dAz7qMscOtXJK\nfgtriltLSSD6rTA9hUAsL/X62rY0wdXuNdijjBb/qvrx7CAV6i37NK1CjABNjsfG\nZM372Ac6zc1EqSrid2IjET1YqyIW2KGLI1R2xbQc98UGlt48OdWu\n-----END RSA PRIVATE KEY-----\n",
}


GITHUB_REPOSITORY_LIST = {
    "total_count": 1,
    "repositories": [
        {
            "id": 1296269,
            "node_id": "MDEwOlJlcG9zaXRvcnkxMjk2MjY5",
            "name": "Hello-World",
            "full_name": "octocat/Hello-World",
            "owner": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "followers_url": "https://api.github.com/users/octocat/followers",
                "following_url": "https://api.github.com/users/octocat/following{/other_user}",
                "gists_url": "https://api.github.com/users/octocat/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/octocat/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/octocat/subscriptions",
                "organizations_url": "https://api.github.com/users/octocat/orgs",
                "repos_url": "https://api.github.com/users/octocat/repos",
                "events_url": "https://api.github.com/users/octocat/events{/privacy}",
                "received_events_url": "https://api.github.com/users/octocat/received_events",
                "type": "User",
                "site_admin": False,
            },
            "private": True,
            "html_url": "https://github.com/octocat/Hello-World",
            "description": "This your first repo!",
            "fork": False,
            "url": "https://api.github.com/repos/octocat/Hello-World",
            "archive_url": "https://api.github.com/repos/octocat/Hello-World/{archive_format}{/ref}",
            "assignees_url": "https://api.github.com/repos/octocat/Hello-World/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/octocat/Hello-World/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/octocat/Hello-World/branches{/branch}",
            "collaborators_url": "https://api.github.com/repos/octocat/Hello-World/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/octocat/Hello-World/comments{/number}",
            "commits_url": "https://api.github.com/repos/octocat/Hello-World/commits{/sha}",
            "compare_url": "https://api.github.com/repos/octocat/Hello-World/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/octocat/Hello-World/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/octocat/Hello-World/contributors",
            "deployments_url": "https://api.github.com/repos/octocat/Hello-World/deployments",
            "downloads_url": "https://api.github.com/repos/octocat/Hello-World/downloads",
            "events_url": "https://api.github.com/repos/octocat/Hello-World/events",
            "forks_url": "https://api.github.com/repos/octocat/Hello-World/forks",
            "git_commits_url": "https://api.github.com/repos/octocat/Hello-World/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/octocat/Hello-World/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/octocat/Hello-World/git/tags{/sha}",
            "git_url": "git:github.com/octocat/Hello-World.git",
            "issue_comment_url": "https://api.github.com/repos/octocat/Hello-World/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/octocat/Hello-World/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/octocat/Hello-World/issues{/number}",
            "keys_url": "https://api.github.com/repos/octocat/Hello-World/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/octocat/Hello-World/labels{/name}",
            "languages_url": "https://api.github.com/repos/octocat/Hello-World/languages",
            "merges_url": "https://api.github.com/repos/octocat/Hello-World/merges",
            "milestones_url": "https://api.github.com/repos/octocat/Hello-World/milestones{/number}",
            "notifications_url": "https://api.github.com/repos/octocat/Hello-World/notifications{?since,all,participating}",
            "pulls_url": "https://api.github.com/repos/octocat/Hello-World/pulls{/number}",
            "releases_url": "https://api.github.com/repos/octocat/Hello-World/releases{/id}",
            "ssh_url": "git@github.com:octocat/Hello-World.git",
            "stargazers_url": "https://api.github.com/repos/octocat/Hello-World/stargazers",
            "statuses_url": "https://api.github.com/repos/octocat/Hello-World/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/octocat/Hello-World/subscribers",
            "subscription_url": "https://api.github.com/repos/octocat/Hello-World/subscription",
            "tags_url": "https://api.github.com/repos/octocat/Hello-World/tags",
            "teams_url": "https://api.github.com/repos/octocat/Hello-World/teams",
            "trees_url": "https://api.github.com/repos/octocat/Hello-World/git/trees{/sha}",
            "clone_url": "https://github.com/octocat/Hello-World.git",
            "mirror_url": "git:git.example.com/octocat/Hello-World",
            "hooks_url": "https://api.github.com/repos/octocat/Hello-World/hooks",
            "svn_url": "https://svn.github.com/octocat/Hello-World",
            "homepage": "https://github.com",
            "language": None,
            "forks_count": 9,
            "stargazers_count": 80,
            "watchers_count": 80,
            "size": 108,
            "default_branch": "master",
            "open_issues_count": 0,
            "is_template": True,
            "topics": ["octocat", "atom", "electron", "api"],
            "has_issues": True,
            "has_projects": True,
            "has_wiki": True,
            "has_pages": False,
            "has_downloads": True,
            "archived": False,
            "disabled": False,
            "visibility": "public",
            "pushed_at": "2011-01-26T19:06:43Z",
            "created_at": "2011-01-26T19:01:12Z",
            "updated_at": "2011-01-26T19:14:43Z",
            "allow_rebase_merge": True,
            "template_repository": None,
            "temp_clone_token": "ABTLWHOULUVAXGTRYU7OC2876QJ2O",
            "allow_squash_merge": True,
            "allow_auto_merge": False,
            "delete_branch_on_merge": True,
            "allow_merge_commit": True,
            "subscribers_count": 42,
            "network_count": 0,
            "license": {
                "key": "mit",
                "name": "MIT License",
                "url": "https://api.github.com/licenses/mit",
                "spdx_id": "MIT",
                "node_id": "MDc6TGljZW5zZW1pdA==",
                "html_url": "https://github.com/licenses/mit",
            },
            "forks": 1,
            "open_issues": 1,
            "watchers": 1,
        }
    ],
}


GITHUB_PING_WEBHOOK_DATA = {
    "zen": "Non-blocking is better than blocking.",
    "hook_id": 100,
    "hook": {
        "type": "App",
        "id": 100,
        "name": "web",
        "active": True,
        "events": ["pull_request", "push"],
        "config": {
            "content_type": "json",
            "url": "http://127-0-0-1.sslip.io/api/connectors/github/webhook",
            "insecure_ssl": "0",
        },
        "updated_at": "2025-07-03T14:15:16Z",
        "created_at": "2025-07-03T14:15:16Z",
        "app_id": 1,
        "deliveries_url": "https://api.github.com/app/hook/deliveries",
    },
}


GITHUB_INSTALLATION_CREATED_WEBHOOK_DATA = {
    "action": "created",
    "installation": {
        "id": 1,
        "client_id": "Iv23li1kL280HIpnXEuO",
        "account": {
            "login": "octocat",
            "id": 100,
            "node_id": "MDxOkludGVncmF0aW9uMQ==",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "repository_selection": "all",
        "repositories_url": "https://api.github.com/installation/repositories",
        "html_url": "https://github.com/settings/installations/1",
        "app_id": 1,
        "app_slug": "zaneops-fredkiss3-app",
        "target_id": 100,
        "target_type": "User",
        "permissions": {
            "contents": "read",
            "metadata": "read",
            "pull_requests": "write",
        },
        "events": ["pull_request", "push"],
        "created_at": "2025-07-03T13:26:01.000+02:00",
        "updated_at": "2025-07-03T13:26:01.000+02:00",
        "single_file_name": None,
        "has_multiple_single_files": False,
        "single_file_paths": [],
        "suspended_by": None,
        "suspended_at": None,
    },
    "repositories": [
        {
            "id": 1,
            "node_id": "MDEwOlJlcG9zaXRvcnkxNDIyNjAyNTk=",
            "name": "Projet-dietetique",
            "full_name": "Fredkiss3/Projet-dietetique",
            "private": False,
        },
        {
            "id": 2,
            "node_id": "MDEwOlJlcG9zaXRvcnkyMDM0MjYwOTk=",
            "name": "reserve_stage",
            "full_name": "Fredkiss3/reserve_stage",
            "private": True,
        },
        {
            "id": 3,
            "node_id": "MDEwOlJlcG9zaXRvcnkyMzg4NjkzNTY=",
            "name": "kge",
            "full_name": "Fredkiss3/kge",
            "private": False,
        },
        {
            "id": 4,
            "node_id": "R_kgDOPFHpfg",
            "name": "private-ac",
            "full_name": "Fredkiss3/private-ac",
            "private": True,
        },
        {
            "id": 5,
            "node_id": "R_kgDOPFHpfg",
            "name": "fredkiss.dev",
            "full_name": "Fredkiss3/fredkiss.dev",
            "private": False,
        },
        {
            "id": 6,
            "node_id": "R_kgDOPFHpfg",
            "name": "simple-pokedex",
            "full_name": "Fredkiss3/simple-pokedex",
            "private": False,
        },
    ],
    "requester": None,
    "sender": {
        "login": "octocat",
        "id": 100,
        "node_id": "MDxOkludGVncmF0aW9uMQ==",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
}

GITHUB_INSTALLATION_REPOS_ADDED_WEBHOOK_DATA = {
    "action": "added",
    "installation": {
        "id": 1,
        "client_id": "Iv23li4AVoPD6g9PK5Jd",
        "account": {
            "login": "octocat",
            "id": 100,
            "node_id": "MDxOkludGVncmF0aW9uMQ==",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "repository_selection": "selected",
        "repositories_url": "https://api.github.com/installation/repositories",
        "html_url": "https://github.com/settings/installations/1",
        "app_id": 1,
        "app_slug": "zaneops-laboriosam-tot",
        "target_id": 100,
        "target_type": "User",
        "permissions": {
            "contents": "read",
            "metadata": "read",
            "pull_requests": "write",
        },
        "events": ["pull_request", "push"],
        "created_at": "2025-07-03T16:14:55.000+02:00",
        "updated_at": "2025-07-03T22:03:03.000+02:00",
        "single_file_name": None,
        "has_multiple_single_files": False,
        "single_file_paths": [],
        "suspended_by": None,
        "suspended_at": None,
    },
    "repository_selection": "selected",
    "repositories_added": [
        {
            "id": 1,
            "node_id": "R_kgDOIWbSlQ",
            "name": "app-directory-next-13",
            "full_name": "Fredkiss3/app-directory-next-13",
            "private": False,
        },
        {
            "id": 2,
            "node_id": "R_kgDOJUcFag",
            "name": "astrosaas",
            "full_name": "Fredkiss3/astrosaas",
            "private": False,
        },
        {
            "id": 3,
            "node_id": "R_kgDOPFHpfg",
            "name": "private-ac",
            "full_name": "Fredkiss3/private-ac",
            "private": True,
        },
    ],
    "repositories_removed": [],
    "requester": None,
    "sender": {
        "login": "octocat",
        "id": 100,
        "node_id": "MDxOkludGVncmF0aW9uMQ==",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
}

GITHUB_INSTALLATION_REPOS_REMOVED_WEBHOOK_DATA = {
    "action": "removed",
    "installation": {
        "id": 1,
        "client_id": "Iv23li4AVoPD6g9PK5Jd",
        "account": {
            "login": "octocat",
            "id": 100,
            "node_id": "MDxOkludGVncmF0aW9uMQ==",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "repository_selection": "selected",
        "repositories_url": "https://api.github.com/installation/repositories",
        "html_url": "https://github.com/settings/installations/1",
        "app_id": 1,
        "app_slug": "zaneops-laboriosam-tot",
        "target_id": 100,
        "target_type": "User",
        "permissions": {
            "contents": "read",
            "metadata": "read",
            "pull_requests": "write",
        },
        "events": ["pull_request", "push"],
        "created_at": "2025-07-03T16:14:55.000+02:00",
        "updated_at": "2025-07-03T22:03:03.000+02:00",
        "single_file_name": None,
        "has_multiple_single_files": False,
        "single_file_paths": [],
        "suspended_by": None,
        "suspended_at": None,
    },
    "repository_selection": "selected",
    "repositories_added": [],
    "repositories_removed": [
        {
            "id": 1,
            "node_id": "MDEwOlJlcG9zaXRvcnkxNDIyNjAyNTk=",
            "name": "Projet-dietetique",
            "full_name": "Fredkiss3/Projet-dietetique",
            "private": False,
        },
        {
            "id": 2,
            "node_id": "MDEwOlJlcG9zaXRvcnkyMDM0MjYwOTk=",
            "name": "reserve_stage",
            "full_name": "Fredkiss3/reserve_stage",
            "private": True,
        },
        {
            "id": 3,
            "node_id": "MDEwOlJlcG9zaXRvcnkyMzg4NjkzNTY=",
            "name": "kge",
            "full_name": "Fredkiss3/kge",
            "private": False,
        },
        {
            "id": 2,
            "node_id": "R_kgDOJUcFag",
            "name": "astrosaas",
            "full_name": "Fredkiss3/astrosaas",
            "private": False,
        },
    ],
    "requester": None,
    "sender": {
        "login": "octocat",
        "id": 100,
        "node_id": "MDxOkludGVncmF0aW9uMQ==",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
}


GITHUB_PUSH_WEBHOOK_EVENT_DATA = {
    "ref": "refs/heads/main",
    "before": "e0522b4784bd16e2e10707fab1081b55f615158d",
    "after": "1c4801f2367acc933760f68e3e611cb2fd1b630d",
    "repository": {
        "id": 1012001150,
        "node_id": "R_kgDOPFHpfg",
        "name": "private-ac",
        "full_name": "Fredkiss3/private-ac",
        "private": True,
        "owner": {
            "login": "github",
            "id": 1,
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjE=",
            "url": "https://api.github.com/orgs/github",
            "gravatar_id": "",
            "type": "User",
            "site_admin": True,
        },
        "html_url": "https://github.com/Fredkiss3/private-ac",
        "description": None,
        "fork": False,
        "url": "https://api.github.com/repos/Fredkiss3/private-ac",
        "created_at": 1751388518,
        "updated_at": "2025-07-01T16:53:30Z",
        "pushed_at": 1752158454,
        "git_url": "git://github.com/Fredkiss3/private-ac.git",
        "ssh_url": "git@github.com:Fredkiss3/private-ac.git",
        "clone_url": "https://github.com/Fredkiss3/private-ac.git",
        "svn_url": "https://github.com/Fredkiss3/private-ac",
        "homepage": None,
        "size": 11,
        "stargazers_count": 0,
        "watchers_count": 0,
        "language": "TypeScript",
        "has_issues": True,
        "has_projects": True,
        "has_downloads": True,
        "has_wiki": False,
        "has_pages": False,
        "has_discussions": False,
        "forks_count": 0,
        "mirror_url": None,
        "archived": False,
        "disabled": False,
        "open_issues_count": 0,
        "license": None,
        "allow_forking": True,
        "is_template": False,
        "web_commit_signoff_required": False,
        "topics": [],
        "visibility": "private",
        "forks": 0,
        "open_issues": 0,
        "watchers": 0,
        "default_branch": "main",
        "stargazers": 0,
        "master_branch": "main",
    },
    "pusher": {"name": "octocat", "email": "octocat@github.com"},
    "sender": {
        "login": "github",
        "id": 1,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjE=",
        "gravatar_id": "",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "site_admin": True,
    },
    "installation": {
        "id": 1,
    },
    "created": False,
    "deleted": False,
    "forced": False,
    "base_ref": None,
    "compare": "https://github.com/Fredkiss3/private-ac/compare/e0522b4784bd...1c4801f2367a",
    "commits": [
        {
            "id": "1c4801f2367acc933760f68e3e611cb2fd1b630d",
            "tree_id": "290164d081ce3e4589c0acb455ed1056cf6a9ab4",
            "distinct": True,
            "message": "simple change",
            "timestamp": "2025-07-10T16:40:50+02:00",
            "url": "https://github.com/Fredkiss3/private-ac/commit/1c4801f2367acc933760f68e3e611cb2fd1b630d",
            "author": {
                "name": "octocat",
                "email": "octocat@github.com",
                "username": "Octocat",
            },
            "committer": {
                "name": "octocat",
                "email": "octocat@github.com",
                "username": "Octocat",
            },
            "added": [],
            "removed": [],
            "modified": ["routes/index.tsx"],
        }
    ],
    "head_commit": {
        "id": "1c4801f2367acc933760f68e3e611cb2fd1b630d",
        "tree_id": "290164d081ce3e4589c0acb455ed1056cf6a9ab4",
        "distinct": True,
        "message": "simple change",
        "timestamp": "2025-07-10T16:40:50+02:00",
        "url": "https://github.com/Fredkiss3/private-ac/commit/1c4801f2367acc933760f68e3e611cb2fd1b630d",
        "author": {
            "name": "octocat",
            "email": "octocat@github.com",
            "username": "Octocat",
        },
        "committer": {
            "name": "octocat",
            "email": "octocat@github.com",
            "username": "Octocat",
        },
        "added": [],
        "removed": [],
        "modified": ["routes/index.tsx"],
    },
}


GITHUB_PULL_REQUEST_WEBHOOK_EVENT_DATA_FOR_FORK = {
    "action": "opened",
    "number": 2,
    "pull_request": {
        "url": "https://api.github.com/repos/Fredkiss3/simple-pokedex/pulls/2",
        "id": 2768079722,
        "node_id": "PR_kwDOJtVhNc6k_Ytq",
        "html_url": "https://github.com/Fredkiss3/simple-pokedex/pull/2",
        "number": 2,
        "state": "open",
        "locked": False,
        "title": "simple test PR",
        "user": {
            "login": "fredk3",
            "id": 146040055,
            "node_id": "U_kgDOCLRk9w",
            "avatar_url": "https://avatars.githubusercontent.com/u/146040055?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fredk3",
            "html_url": "https://github.com/fredk3",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "body": None,
        "created_at": "2025-08-23T04:44:28Z",
        "updated_at": "2025-08-23T04:44:28Z",
        "closed_at": None,
        "merged_at": None,
        "merge_commit_sha": None,
        "assignee": None,
        "assignees": [],
        "requested_reviewers": [],
        "requested_teams": [],
        "labels": [],
        "milestone": None,
        "draft": False,
        "commits_url": "https://api.github.com/repos/Fredkiss3/simple-pokedex/pulls/2/commits",
        "comments_url": "https://api.github.com/repos/Fredkiss3/simple-pokedex/issues/2/comments",
        "head": {
            "label": "fredk3:test-fork-pr",
            "ref": "test-fork-pr",
            "sha": "3c475cdd3ed9d78d99a45d8d3a28cd201281467f",
            "user": {
                "login": "fredk3",
                "id": 146040055,
                "node_id": "U_kgDOCLRk9w",
                "avatar_url": "https://avatars.githubusercontent.com/u/146040055?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/fredk3",
                "html_url": "https://github.com/fredk3",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "repo": {
                "id": 1043067029,
                "node_id": "R_kgDOPivwlQ",
                "name": "simple-pokedex",
                "full_name": "fredk3/simple-pokedex",
                "private": False,
                "owner": {
                    "login": "fredk3",
                    "id": 146040055,
                    "node_id": "U_kgDOCLRk9w",
                    "avatar_url": "https://avatars.githubusercontent.com/u/146040055?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/fredk3",
                    "html_url": "https://github.com/fredk3",
                    "type": "User",
                    "user_view_type": "public",
                    "site_admin": False,
                },
                "html_url": "https://github.com/fredk3/simple-pokedex",
                "description": None,
                "fork": True,
                "created_at": "2025-08-23T04:32:38Z",
                "updated_at": "2025-08-23T04:32:38Z",
                "pushed_at": "2025-08-23T04:44:13Z",
                "git_url": "git://github.com/fredk3/simple-pokedex.git",
                "ssh_url": "git@github.com:fredk3/simple-pokedex.git",
                "clone_url": "https://github.com/fredk3/simple-pokedex.git",
                "svn_url": "https://github.com/fredk3/simple-pokedex",
                "homepage": "https://vercel-streaming-bug.vercel.app",
                "size": 234,
                "stargazers_count": 0,
                "watchers_count": 0,
                "language": None,
                "has_issues": False,
                "has_projects": True,
                "has_downloads": True,
                "has_wiki": True,
                "has_pages": False,
                "has_discussions": False,
                "forks_count": 0,
                "mirror_url": None,
                "archived": False,
                "disabled": False,
                "open_issues_count": 0,
                "license": None,
                "allow_forking": True,
                "is_template": False,
                "web_commit_signoff_required": False,
                "topics": [],
                "visibility": "public",
                "forks": 0,
                "open_issues": 0,
                "watchers": 0,
                "default_branch": "main",
                "allow_squash_merge": True,
                "allow_merge_commit": True,
                "allow_rebase_merge": True,
                "allow_auto_merge": False,
                "delete_branch_on_merge": False,
                "allow_update_branch": False,
                "use_squash_pr_title_as_default": False,
                "squash_merge_commit_message": "COMMIT_MESSAGES",
                "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
                "merge_commit_message": "PR_TITLE",
                "merge_commit_title": "MERGE_MESSAGE",
            },
        },
        "base": {
            "label": "Fredkiss3:main",
            "ref": "main",
            "sha": "2aaadc2673ab2800cdd9fa838a813db933db8816",
            "user": {
                "login": "Fredkiss3",
                "id": 38298743,
                "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Fredkiss3",
                "html_url": "https://github.com/Fredkiss3",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "repo": {
                "id": 651518261,
                "node_id": "R_kgDOJtVhNQ",
                "name": "simple-pokedex",
                "full_name": "Fredkiss3/simple-pokedex",
                "private": False,
                "owner": {
                    "login": "Fredkiss3",
                    "id": 38298743,
                    "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                    "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Fredkiss3",
                    "html_url": "https://github.com/Fredkiss3",
                    "type": "User",
                    "user_view_type": "public",
                    "site_admin": False,
                },
                "html_url": "https://github.com/Fredkiss3/simple-pokedex",
                "description": None,
                "fork": False,
                "url": "https://api.github.com/repos/Fredkiss3/simple-pokedex",
                "created_at": "2023-06-09T12:17:38Z",
                "updated_at": "2025-07-21T20:42:36Z",
                "pushed_at": "2025-08-23T02:53:24Z",
                "git_url": "git://github.com/Fredkiss3/simple-pokedex.git",
                "ssh_url": "git@github.com:Fredkiss3/simple-pokedex.git",
                "clone_url": "https://github.com/Fredkiss3/simple-pokedex.git",
                "svn_url": "https://github.com/Fredkiss3/simple-pokedex",
                "homepage": "https://vercel-streaming-bug.vercel.app",
                "size": 234,
                "stargazers_count": 0,
                "watchers_count": 0,
                "language": "TypeScript",
                "has_issues": True,
                "has_projects": True,
                "has_downloads": True,
                "has_wiki": True,
                "has_pages": False,
                "has_discussions": False,
                "forks_count": 1,
                "mirror_url": None,
                "archived": False,
                "disabled": False,
                "open_issues_count": 2,
                "license": None,
                "allow_forking": True,
                "is_template": False,
                "web_commit_signoff_required": False,
                "topics": [],
                "visibility": "public",
                "forks": 1,
                "open_issues": 2,
                "watchers": 0,
                "default_branch": "main",
                "allow_squash_merge": True,
                "allow_merge_commit": True,
                "allow_rebase_merge": True,
                "allow_auto_merge": False,
                "delete_branch_on_merge": False,
                "allow_update_branch": False,
                "use_squash_pr_title_as_default": False,
                "squash_merge_commit_message": "COMMIT_MESSAGES",
                "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
                "merge_commit_message": "PR_TITLE",
                "merge_commit_title": "MERGE_MESSAGE",
            },
        },
        "author_association": "NONE",
        "auto_merge": None,
        "active_lock_reason": None,
        "merged": False,
        "mergeable": None,
        "rebaseable": None,
        "mergeable_state": "unknown",
        "merged_by": None,
        "comments": 0,
        "review_comments": 0,
        "maintainer_can_modify": True,
        "commits": 1,
        "additions": 1,
        "deletions": 1,
        "changed_files": 1,
    },
    "repository": {
        "id": 651518261,
        "node_id": "R_kgDOJtVhNQ",
        "name": "simple-pokedex",
        "full_name": "Fredkiss3/simple-pokedex",
        "private": False,
        "owner": {
            "login": "Fredkiss3",
            "id": 38298743,
            "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
            "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Fredkiss3",
            "html_url": "https://github.com/Fredkiss3",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "html_url": "https://github.com/Fredkiss3/simple-pokedex",
        "description": None,
        "fork": False,
        "created_at": "2023-06-09T12:17:38Z",
        "updated_at": "2025-07-21T20:42:36Z",
        "pushed_at": "2025-08-23T02:53:24Z",
        "git_url": "git://github.com/Fredkiss3/simple-pokedex.git",
        "ssh_url": "git@github.com:Fredkiss3/simple-pokedex.git",
        "clone_url": "https://github.com/Fredkiss3/simple-pokedex.git",
        "svn_url": "https://github.com/Fredkiss3/simple-pokedex",
        "homepage": "https://vercel-streaming-bug.vercel.app",
        "size": 234,
        "stargazers_count": 0,
        "watchers_count": 0,
        "language": "TypeScript",
        "has_issues": True,
        "has_projects": True,
        "has_downloads": True,
        "has_wiki": True,
        "has_pages": False,
        "has_discussions": False,
        "forks_count": 1,
        "mirror_url": None,
        "archived": False,
        "disabled": False,
        "open_issues_count": 2,
        "license": None,
        "allow_forking": True,
        "is_template": False,
        "web_commit_signoff_required": False,
        "topics": [],
        "visibility": "public",
        "forks": 1,
        "open_issues": 2,
        "watchers": 0,
        "default_branch": "main",
    },
    "sender": {
        "login": "fredk3",
        "id": 146040055,
        "node_id": "U_kgDOCLRk9w",
        "avatar_url": "https://avatars.githubusercontent.com/u/146040055?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fredk3",
        "html_url": "https://github.com/fredk3",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
    "installation": {
        "id": 1,
    },
}

GITHUB_PULL_REQUEST_WEBHOOK_EVENT_DATA = {
    "action": "opened",
    "number": 42,
    "pull_request": {
        "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/pulls/42",
        "id": 2767820279,
        "node_id": "PR_kwDOHQuGUs6k-ZX3",
        "html_url": "https://github.com/Fredkiss3/fredkiss.dev/pull/42",
        "number": 42,
        "state": "open",
        "locked": False,
        "title": "New cv",
        "user": {
            "login": "Fredkiss3",
            "id": 38298743,
            "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
            "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Fredkiss3",
            "html_url": "https://github.com/Fredkiss3",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "body": None,
        "created_at": "2025-08-23T00:15:51Z",
        "updated_at": "2025-08-23T00:15:51Z",
        "closed_at": None,
        "merged_at": None,
        "merge_commit_sha": None,
        "assignee": None,
        "assignees": [],
        "requested_reviewers": [],
        "requested_teams": [],
        "labels": [],
        "milestone": None,
        "draft": False,
        "comments_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/issues/42/comments",
        "head": {
            "label": "Fredkiss3:new-cv",
            "ref": "new-cv",
            "sha": "d6bb2939755236c798153113d59662662611810c",
            "user": {
                "login": "Fredkiss3",
                "id": 38298743,
                "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Fredkiss3",
                "html_url": "https://github.com/Fredkiss3",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "repo": {
                "id": 487294546,
                "node_id": "R_kgDOHQuGUg",
                "name": "fredkiss.dev",
                "full_name": "Fredkiss3/fredkiss.dev",
                "private": False,
                "owner": {
                    "login": "Fredkiss3",
                    "id": 38298743,
                    "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                    "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Fredkiss3",
                    "html_url": "https://github.com/Fredkiss3",
                    "type": "User",
                    "user_view_type": "public",
                    "site_admin": False,
                },
                "html_url": "https://github.com/Fredkiss3/fredkiss.dev",
                "description": "My personnal portfolio website",
                "fork": False,
                "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev",
                "created_at": "2022-04-30T14:12:24Z",
                "updated_at": "2025-08-01T04:59:17Z",
                "pushed_at": "2025-08-14T21:58:27Z",
                "git_url": "git://github.com/Fredkiss3/fredkiss.dev.git",
                "ssh_url": "git@github.com:Fredkiss3/fredkiss.dev.git",
                "clone_url": "https://github.com/Fredkiss3/fredkiss.dev.git",
                "svn_url": "https://github.com/Fredkiss3/fredkiss.dev",
                "homepage": "https://fredkiss.dev",
                "size": 59642,
                "stargazers_count": 4,
                "watchers_count": 4,
                "language": "Astro",
                "has_issues": True,
                "has_projects": True,
                "has_downloads": True,
                "has_wiki": True,
                "has_pages": False,
                "has_discussions": False,
                "forks_count": 1,
                "mirror_url": None,
                "archived": False,
                "disabled": False,
                "open_issues_count": 2,
                "license": None,
                "allow_forking": True,
                "is_template": False,
                "web_commit_signoff_required": False,
                "topics": ["mdx", "nextjs", "typescript"],
                "visibility": "public",
                "forks": 1,
                "open_issues": 2,
                "watchers": 4,
                "default_branch": "main",
                "allow_squash_merge": True,
                "allow_merge_commit": True,
                "allow_rebase_merge": True,
                "allow_auto_merge": False,
                "delete_branch_on_merge": False,
                "allow_update_branch": False,
                "use_squash_pr_title_as_default": False,
                "squash_merge_commit_message": "COMMIT_MESSAGES",
                "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
                "merge_commit_message": "PR_TITLE",
                "merge_commit_title": "MERGE_MESSAGE",
            },
        },
        "base": {
            "label": "Fredkiss3:main",
            "ref": "main",
            "sha": "6566a41adc55cf3942f5b0ed279777a32b89d4b6",
            "user": {
                "login": "Fredkiss3",
                "id": 38298743,
                "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Fredkiss3",
                "html_url": "https://github.com/Fredkiss3",
                "followers_url": "https://api.github.com/users/Fredkiss3/followers",
                "following_url": "https://api.github.com/users/Fredkiss3/following{/other_user}",
                "gists_url": "https://api.github.com/users/Fredkiss3/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Fredkiss3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Fredkiss3/subscriptions",
                "organizations_url": "https://api.github.com/users/Fredkiss3/orgs",
                "repos_url": "https://api.github.com/users/Fredkiss3/repos",
                "events_url": "https://api.github.com/users/Fredkiss3/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Fredkiss3/received_events",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "repo": {
                "id": 487294546,
                "node_id": "R_kgDOHQuGUg",
                "name": "fredkiss.dev",
                "full_name": "Fredkiss3/fredkiss.dev",
                "private": False,
                "owner": {
                    "login": "Fredkiss3",
                    "id": 38298743,
                    "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
                    "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/Fredkiss3",
                    "html_url": "https://github.com/Fredkiss3",
                    "followers_url": "https://api.github.com/users/Fredkiss3/followers",
                    "following_url": "https://api.github.com/users/Fredkiss3/following{/other_user}",
                    "gists_url": "https://api.github.com/users/Fredkiss3/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/Fredkiss3/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/Fredkiss3/subscriptions",
                    "organizations_url": "https://api.github.com/users/Fredkiss3/orgs",
                    "repos_url": "https://api.github.com/users/Fredkiss3/repos",
                    "events_url": "https://api.github.com/users/Fredkiss3/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/Fredkiss3/received_events",
                    "type": "User",
                    "user_view_type": "public",
                    "site_admin": False,
                },
                "html_url": "https://github.com/Fredkiss3/fredkiss.dev",
                "description": "My personnal portfolio website",
                "fork": False,
                "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev",
                "forks_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/forks",
                "keys_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/keys{/key_id}",
                "collaborators_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/collaborators{/collaborator}",
                "teams_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/teams",
                "hooks_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/hooks",
                "issue_events_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/issues/events{/number}",
                "events_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/events",
                "assignees_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/assignees{/user}",
                "branches_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/branches{/branch}",
                "tags_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/tags",
                "blobs_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/git/blobs{/sha}",
                "git_tags_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/git/tags{/sha}",
                "git_refs_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/git/refs{/sha}",
                "trees_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/git/trees{/sha}",
                "statuses_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/statuses/{sha}",
                "languages_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/languages",
                "stargazers_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/stargazers",
                "contributors_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/contributors",
                "subscribers_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/subscribers",
                "subscription_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/subscription",
                "commits_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/commits{/sha}",
                "git_commits_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/git/commits{/sha}",
                "comments_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/comments{/number}",
                "issue_comment_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/issues/comments{/number}",
                "contents_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/contents/{+path}",
                "compare_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/compare/{base}...{head}",
                "merges_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/merges",
                "archive_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/{archive_format}{/ref}",
                "downloads_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/downloads",
                "issues_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/issues{/number}",
                "pulls_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/pulls{/number}",
                "milestones_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/milestones{/number}",
                "notifications_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/notifications{?since,all,participating}",
                "labels_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/labels{/name}",
                "releases_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/releases{/id}",
                "deployments_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/deployments",
                "created_at": "2022-04-30T14:12:24Z",
                "updated_at": "2025-08-01T04:59:17Z",
                "pushed_at": "2025-08-14T21:58:27Z",
                "git_url": "git://github.com/Fredkiss3/fredkiss.dev.git",
                "ssh_url": "git@github.com:Fredkiss3/fredkiss.dev.git",
                "clone_url": "https://github.com/Fredkiss3/fredkiss.dev.git",
                "svn_url": "https://github.com/Fredkiss3/fredkiss.dev",
                "homepage": "https://fredkiss.dev",
                "size": 59642,
                "stargazers_count": 4,
                "watchers_count": 4,
                "language": "Astro",
                "has_issues": True,
                "has_projects": True,
                "has_downloads": True,
                "has_wiki": True,
                "has_pages": False,
                "has_discussions": False,
                "forks_count": 1,
                "mirror_url": None,
                "archived": False,
                "disabled": False,
                "open_issues_count": 2,
                "license": None,
                "allow_forking": True,
                "is_template": False,
                "web_commit_signoff_required": False,
                "topics": ["mdx", "nextjs", "typescript"],
                "visibility": "public",
                "forks": 1,
                "open_issues": 2,
                "watchers": 4,
                "default_branch": "main",
                "allow_squash_merge": True,
                "allow_merge_commit": True,
                "allow_rebase_merge": True,
                "allow_auto_merge": False,
                "delete_branch_on_merge": False,
                "allow_update_branch": False,
                "use_squash_pr_title_as_default": False,
                "squash_merge_commit_message": "COMMIT_MESSAGES",
                "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
                "merge_commit_message": "PR_TITLE",
                "merge_commit_title": "MERGE_MESSAGE",
            },
        },
        "author_association": "OWNER",
        "auto_merge": None,
        "active_lock_reason": None,
        "merged": False,
        "mergeable": None,
        "rebaseable": None,
        "mergeable_state": "unknown",
        "merged_by": None,
        "comments": 0,
        "review_comments": 0,
        "maintainer_can_modify": False,
        "commits": 3,
        "additions": 1,
        "deletions": 1,
        "changed_files": 2,
    },
    "repository": {
        "id": 487294546,
        "node_id": "R_kgDOHQuGUg",
        "name": "fredkiss.dev",
        "full_name": "Fredkiss3/fredkiss.dev",
        "private": False,
        "owner": {
            "login": "Fredkiss3",
            "id": 38298743,
            "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
            "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Fredkiss3",
            "html_url": "https://github.com/Fredkiss3",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "html_url": "https://github.com/Fredkiss3/fredkiss.dev",
        "description": "My personnal portfolio website",
        "fork": False,
        "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev",
        "created_at": "2022-04-30T14:12:24Z",
        "updated_at": "2025-08-01T04:59:17Z",
        "pushed_at": "2025-08-14T21:58:27Z",
        "git_url": "git://github.com/Fredkiss3/fredkiss.dev.git",
        "ssh_url": "git@github.com:Fredkiss3/fredkiss.dev.git",
        "clone_url": "https://github.com/Fredkiss3/fredkiss.dev.git",
        "svn_url": "https://github.com/Fredkiss3/fredkiss.dev",
        "homepage": "https://fredkiss.dev",
        "size": 59642,
        "stargazers_count": 4,
        "watchers_count": 4,
        "language": "Astro",
        "has_issues": True,
        "has_projects": True,
        "has_downloads": True,
        "has_wiki": True,
        "has_pages": False,
        "has_discussions": False,
        "forks_count": 1,
        "mirror_url": None,
        "archived": False,
        "disabled": False,
        "open_issues_count": 2,
        "license": None,
        "allow_forking": True,
        "is_template": False,
        "web_commit_signoff_required": False,
        "topics": ["mdx", "nextjs", "typescript"],
        "visibility": "public",
        "forks": 1,
        "open_issues": 2,
        "watchers": 4,
        "default_branch": "main",
    },
    "sender": {
        "login": "Fredkiss3",
        "id": 38298743,
        "node_id": "MDQ6VXNlcjM4Mjk4NzQz",
        "avatar_url": "https://avatars.githubusercontent.com/u/38298743?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fredkiss3",
        "html_url": "https://github.com/Fredkiss3",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
    "installation": {
        "id": 1,
    },
}

GITHUB_COMMENTS_DATA = {
    "id": 1,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE=",
    "url": "https://api.github.com/repos/octocat/Hello-World/issues/comments/1",
    "html_url": "https://github.com/octocat/Hello-World/issues/1347#issuecomment-1",
    "body": "Me too",
    "user": {
        "login": "octocat",
        "id": 1,
        "node_id": "MDQ6VXNlcjE=",
        "avatar_url": "https://github.com/images/error/octocat_happy.gif",
        "gravatar_id": "",
        "type": "User",
        "site_admin": False,
    },
    "created_at": "2011-04-14T16:00:49Z",
    "updated_at": "2011-04-14T16:00:49Z",
    "issue_url": "https://api.github.com/repos/octocat/Hello-World/issues/1347",
    "author_association": "COLLABORATOR",
}


def mock_github_comments_api():
    """
    Mock GitHub Comments API (issues/{issue_number}/comments).

    Supported endpoints:
      - POST /repos/{owner}/{repo}/issues/{issue_number}/comments
          -> creates a comment (stored in-memory)
      - GET  /repos/{owner}/{repo}/issues/comments/1
          -> returns the stored comment if it exists, 404 otherwise
      - PATCH /repos/{owner}/{repo}/issues/comments/1
          -> updates the body of the stored comment, 404 otherwise

    NOTE: This mock only supports a single static comment (id=1).
    The "body" field is dynamic based on request payload.
    """
    # In-memory store (only 1 comment for simplicity)
    COMMENT_STORE = {}

    github_comment_api_pattern = re.compile(
        r"^https://api\.github\.com/repos/[^/]+/[^/]+/issues/\d+/comments/?$",
        re.IGNORECASE,
    )
    github_single_comment_pattern = re.compile(
        r"^https://api\.github\.com/repos/[^/]+/[^/]+/issues/comments/(\d+)/?$",
        re.IGNORECASE,
    )

    def post_comment_callback(request):
        payload = json.loads(request.body.decode("utf-8"))
        body_text = payload.get("body", "")

        comment_id = GITHUB_COMMENTS_DATA["id"]  # static id=1 for now
        COMMENT_STORE[comment_id] = {**GITHUB_COMMENTS_DATA, "body": body_text}
        return (status.HTTP_201_CREATED, {}, json.dumps(COMMENT_STORE[comment_id]))

    def get_comment_callback(request):
        matched = github_single_comment_pattern.match(request.url)
        if not matched:
            return (
                status.HTTP_400_BAD_REQUEST,
                {},
                json.dumps({"message": "Bad Request"}),
            )

        comment_id = int(matched.group(1))
        if comment_id not in COMMENT_STORE:
            return (status.HTTP_404_NOT_FOUND, {}, json.dumps({"message": "Not Found"}))

        return (status.HTTP_200_OK, {}, json.dumps(COMMENT_STORE[comment_id]))

    def put_comment_callback(request):
        matched = github_single_comment_pattern.match(request.url)
        if not matched:
            return (
                status.HTTP_400_BAD_REQUEST,
                {},
                json.dumps({"message": "Bad Request"}),
            )

        comment_id = int(matched.group(1))
        if comment_id not in COMMENT_STORE:
            return (status.HTTP_404_NOT_FOUND, {}, json.dumps({"message": "Not Found"}))

        payload = json.loads(request.body.decode("utf-8"))
        new_body = payload.get("body", COMMENT_STORE[comment_id]["body"])
        COMMENT_STORE[comment_id]["body"] = new_body
        return (status.HTTP_200_OK, {}, json.dumps(COMMENT_STORE[comment_id]))

    # Register the mocks
    responses.add_callback(
        responses.POST,
        github_comment_api_pattern,
        callback=post_comment_callback,
        content_type="application/json",
    )

    responses.add_callback(
        responses.GET,
        github_single_comment_pattern,
        callback=get_comment_callback,
        content_type="application/json",
    )

    responses.add_callback(
        responses.PATCH,  # GitHub uses PATCH for updating comments
        github_single_comment_pattern,
        callback=put_comment_callback,
        content_type="application/json",
    )

    return COMMENT_STORE


GITHUB_SINGLE_PULL_REQUEST_DATA = {
    "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/pulls/1",
    "id": 1,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MQ==",
    "html_url": "https://github.com/Fredkiss3/fredkiss.dev/pull/1",
    "number": 1,
    "state": "open",
    "locked": True,
    "title": "Amazing new feature",
    "user": {
        "login": "octocat",
        "id": 1,
        "node_id": "MDQ6VXNlcjE=",
        "avatar_url": "https://github.com/images/error/octocat_happy.gif",
        "gravatar_id": "",
        "url": "https://api.github.com/users/octocat",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
    "body": "Please pull these awesome changes in!",
    "created_at": "2011-01-26T19:01:12Z",
    "updated_at": "2011-01-26T19:01:12Z",
    "closed_at": "2011-01-26T19:01:12Z",
    "merged_at": "2011-01-26T19:01:12Z",
    "merge_commit_sha": "e5bd3914e2e596debea16f433f57875b5b90bcd6",
    "assignee": {
        "login": "octocat",
        "id": 1,
        "node_id": "MDQ6VXNlcjE=",
        "avatar_url": "https://github.com/images/error/octocat_happy.gif",
        "gravatar_id": "",
        "url": "https://api.github.com/users/octocat",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
    "assignees": [
        {
            "login": "octocat",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/octocat_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/octocat",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        {
            "login": "hubot",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/hubot_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hubot",
            "html_url": "https://github.com/hubot",
            "type": "User",
            "user_view_type": "public",
            "site_admin": True,
        },
    ],
    "requested_reviewers": [
        {
            "login": "other_user",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/other_user_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/other_user",
            "html_url": "https://github.com/other_user",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        }
    ],
    "requested_teams": [
        {
            "id": 1,
            "node_id": "MDQ6VGVhbTE=",
            "url": "https://api.github.com/teams/1",
            "html_url": "https://github.com/orgs/github/teams/justice-league",
            "name": "Justice League",
            "slug": "justice-league",
            "description": "A great team.",
            "privacy": "closed",
            "notification_setting": "notifications_enabled",
            "permission": "admin",
            "members_url": "https://api.github.com/teams/1/members{/member}",
            "repositories_url": "https://api.github.com/teams/1/repos",
        }
    ],
    "labels": [
        {
            "id": 208045946,
            "node_id": "MDU6TGFiZWwyMDgwNDU5NDY=",
            "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/labels/bug",
            "name": "bug",
            "description": "Something isn't working",
            "color": "f29513",
            "default": True,
        }
    ],
    "milestone": {
        "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/milestones/1",
        "html_url": "https://github.com/Fredkiss3/fredkiss.dev/milestones/v1.0",
        "labels_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/milestones/1/labels",
        "id": 1002604,
        "node_id": "MDk6TWlsZXN0b25lMTAwMjYwNA==",
        "number": 1,
        "state": "open",
        "title": "v1.0",
        "description": "Tracking milestone for version 1.0",
        "creator": {
            "login": "octocat",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/octocat_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/octocat",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "open_issues": 4,
        "closed_issues": 8,
        "created_at": "2011-04-10T20:09:31Z",
        "updated_at": "2014-03-03T18:58:10Z",
        "closed_at": "2013-02-12T13:22:01Z",
        "due_on": "2012-10-09T23:39:01Z",
    },
    "draft": False,
    "comments_url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev/issues/1347/comments",
    "head": {
        "label": "octocat:new-topic",
        "ref": "new-topic",
        "sha": "6dcb09b5b57875f334f61aebed695e2e4193db5e",
        "user": {
            "login": "octocat",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/octocat_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/octocat",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "repo": {
            "id": 1296269,
            "node_id": "MDEwOlJlcG9zaXRvcnkxMjk2MjY5",
            "name": "Hello-World",
            "full_name": "Fredkiss3/fredkiss.dev",
            "private": False,
            "owner": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "html_url": "https://github.com/Fredkiss3/fredkiss.dev",
            "description": "This your first repo!",
            "fork": False,
            "url": "https://api.github.com/repos/Fredkiss3/fredkiss.dev",
            "created_at": "2011-01-26T19:01:12Z",
            "updated_at": "2011-01-26T19:14:43Z",
            "pushed_at": "2011-01-26T19:06:43Z",
            "git_url": "git:github.com/Fredkiss3/fredkiss.dev.git",
            "ssh_url": "git@github.com:Fredkiss3/fredkiss.dev.git",
            "clone_url": "https://github.com/Fredkiss3/fredkiss.dev.git",
            "svn_url": "https://svn.github.com/Fredkiss3/fredkiss.dev",
            "homepage": "https://github.com",
            "size": 108,
            "stargazers_count": 80,
            "watchers_count": 80,
            "language": None,
            "has_issues": True,
            "has_projects": True,
            "has_downloads": True,
            "has_wiki": True,
            "has_pages": False,
            "has_discussions": False,
            "forks_count": 9,
            "mirror_url": "git:git.example.com/Fredkiss3/fredkiss.dev",
            "archived": False,
            "disabled": False,
            "open_issues_count": 0,
            "license": {
                "key": "mit",
                "name": "MIT License",
                "url": "https://api.github.com/licenses/mit",
                "spdx_id": "MIT",
                "node_id": "MDc6TGljZW5zZW1pdA==",
            },
            "allow_forking": True,
            "is_template": False,
            "web_commit_signoff_required": False,
            "topics": ["octocat", "atom", "electron", "api"],
            "visibility": "public",
            "forks": 123,
            "open_issues": 123,
            "watchers": 123,
            "default_branch": "master",
            "allow_squash_merge": True,
            "allow_merge_commit": True,
            "allow_rebase_merge": True,
            "allow_auto_merge": False,
            "delete_branch_on_merge": False,
            "allow_update_branch": False,
            "use_squash_pr_title_as_default": False,
            "squash_merge_commit_message": "COMMIT_MESSAGES",
            "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
            "merge_commit_message": "PR_TITLE",
            "merge_commit_title": "MERGE_MESSAGE",
        },
    },
    "base": {
        "label": "octocat:master",
        "ref": "master",
        "sha": "6dcb09b5b57875f334f61aebed695e2e4193db5e",
        "user": {
            "login": "octocat",
            "id": 1,
            "node_id": "MDQ6VXNlcjE=",
            "avatar_url": "https://github.com/images/error/octocat_happy.gif",
            "gravatar_id": "",
            "url": "https://api.github.com/users/octocat",
            "html_url": "https://github.com/octocat",
            "type": "User",
            "user_view_type": "public",
            "site_admin": False,
        },
        "repo": {
            "id": 1296269,
            "node_id": "MDEwOlJlcG9zaXRvcnkxMjk2MjY5",
            "name": "Hello-World",
            "full_name": "Fredkiss3/fredkiss.dev",
            "private": False,
            "owner": {
                "login": "octocat",
                "id": 1,
                "node_id": "MDQ6VXNlcjE=",
                "avatar_url": "https://github.com/images/error/octocat_happy.gif",
                "gravatar_id": "",
                "url": "https://api.github.com/users/octocat",
                "html_url": "https://github.com/octocat",
                "type": "User",
                "user_view_type": "public",
                "site_admin": False,
            },
            "html_url": "https://github.com/octocat/Hello-World",
            "description": "This your first repo!",
            "fork": False,
            "url": "https://api.github.com/repos/octocat/Hello-World",
            "created_at": "2011-01-26T19:01:12Z",
            "updated_at": "2011-01-26T19:14:43Z",
            "pushed_at": "2011-01-26T19:06:43Z",
            "git_url": "git:github.com/octocat/Hello-World.git",
            "ssh_url": "git@github.com:octocat/Hello-World.git",
            "clone_url": "https://github.com/octocat/Hello-World.git",
            "svn_url": "https://svn.github.com/octocat/Hello-World",
            "homepage": "https://github.com",
            "size": 108,
            "stargazers_count": 80,
            "watchers_count": 80,
            "language": None,
            "has_issues": True,
            "has_projects": True,
            "has_downloads": True,
            "has_wiki": True,
            "has_pages": False,
            "has_discussions": False,
            "forks_count": 9,
            "mirror_url": "git:git.example.com/octocat/Hello-World",
            "archived": False,
            "disabled": False,
            "open_issues_count": 0,
            "license": {
                "key": "mit",
                "name": "MIT License",
                "url": "https://api.github.com/licenses/mit",
                "spdx_id": "MIT",
                "node_id": "MDc6TGljZW5zZW1pdA==",
            },
            "allow_forking": True,
            "is_template": False,
            "web_commit_signoff_required": False,
            "topics": ["octocat", "atom", "electron", "api"],
            "visibility": "public",
            "forks": 123,
            "open_issues": 123,
            "watchers": 123,
            "default_branch": "master",
            "allow_squash_merge": True,
            "allow_merge_commit": True,
            "allow_rebase_merge": True,
            "allow_auto_merge": False,
            "delete_branch_on_merge": False,
            "allow_update_branch": False,
            "use_squash_pr_title_as_default": False,
            "squash_merge_commit_message": "COMMIT_MESSAGES",
            "squash_merge_commit_title": "COMMIT_OR_PR_TITLE",
            "merge_commit_message": "PR_TITLE",
            "merge_commit_title": "MERGE_MESSAGE",
        },
    },
    "author_association": "OWNER",
    "auto_merge": None,
    "merged": False,
    "mergeable": True,
    "rebaseable": True,
    "mergeable_state": "clean",
    "merged_by": {
        "login": "octocat",
        "id": 1,
        "node_id": "MDQ6VXNlcjE=",
        "avatar_url": "https://github.com/images/error/octocat_happy.gif",
        "gravatar_id": "",
        "url": "https://api.github.com/users/octocat",
        "html_url": "https://github.com/octocat",
        "type": "User",
        "user_view_type": "public",
        "site_admin": False,
    },
    "comments": 10,
    "review_comments": 0,
    "maintainer_can_modify": True,
    "commits": 3,
    "additions": 100,
    "deletions": 3,
    "changed_files": 5,
}


def mock_github_pr_api():

    github_pr_api_pattern = re.compile(
        r"^https://api\.github\.com/repos/[^/]+/[^/]+/pulls/(\d+)/?$",
        re.IGNORECASE,
    )

    def get_pr_callback(request):
        pr_data = GITHUB_SINGLE_PULL_REQUEST_DATA
        matched = github_pr_api_pattern.match(request.url)
        if matched and int(matched.group(1)) == pr_data["number"]:
            return (status.HTTP_200_OK, {}, json.dumps(GITHUB_SINGLE_PULL_REQUEST_DATA))
        return (status.HTTP_404_NOT_FOUND, {}, json.dumps({"message": "Not Found"}))

    responses.add_callback(
        responses.GET,
        url=github_pr_api_pattern,
        callback=get_pr_callback,
        content_type="application/json",
    )


# ==============================
# .      GITLAB WEBHOOKS       #
# ==============================

GITLAB_ACCESS_TOKEN_DATA = {
    "access_token": "de6780bc506a0446309bd9362820ba8aed28aa506c71eedbe1c5c4f9dd350e54",
    "token_type": "bearer",
    "expires_in": 7200,
    "refresh_token": "8257e65c97202ed1726cf9571600918f3bffb2544b26e00a61df9897668c33a1",
    "created_at": 1607635748,
}

GITLAB_PROJECT_LIST = [
    {
        "id": 4,
        "description": None,
        "name": "Diaspora Client",
        "name_with_namespace": "Diaspora / Diaspora Client",
        "path": "diaspora-client",
        "path_with_namespace": "diaspora/diaspora-client",
        "created_at": "2013-09-30T13:46:02Z",
        "default_branch": "main",
        "tag_list": ["example", "disapora client"],
        "topics": ["example", "disapora client"],
        "ssh_url_to_repo": "git@gitlab.example.com:diaspora/diaspora-client.git",
        "http_url_to_repo": "https://gitlab.example.com/diaspora/diaspora-client.git",
        "web_url": "https://gitlab.example.com/diaspora/diaspora-client",
        "avatar_url": "https://gitlab.example.com/uploads/project/avatar/4/uploads/avatar.png",
        "star_count": 0,
        "last_activity_at": "2013-09-30T13:46:02Z",
        "namespace": {
            "id": 2,
            "name": "Diaspora",
            "path": "diaspora",
            "kind": "group",
            "full_path": "diaspora",
            "parent_id": None,
            "avatar_url": None,
            "web_url": "https://gitlab.example.com/diaspora",
        },
        "visibility": "public",
        "permissions": {
            "project_access": {
                "access_level": 40,  # Maintainer
                "notification_level": 3,
            },
            "group_access": None,
        },
    },
    {
        "id": 71408858,
        "description": None,
        "name": "M346 Ref Card 03",
        "name_with_namespace": "Mykola Zabielin / M346 Ref Card 03",
        "path": "m346-ref-card-03",
        "path_with_namespace": "SomeOneUnkn0wn/m346-ref-card-03",
        "created_at": "2025-07-06T18:53:00.603Z",
        "default_branch": "main",
        "tag_list": [],
        "topics": [],
        "ssh_url_to_repo": "git@gitlab.com:SomeOneUnkn0wn/m346-ref-card-03.git",
        "http_url_to_repo": "https://gitlab.com/SomeOneUnkn0wn/m346-ref-card-03.git",
        "web_url": "https://gitlab.com/SomeOneUnkn0wn/m346-ref-card-03",
        "readme_url": "https://gitlab.com/SomeOneUnkn0wn/m346-ref-card-03/-/blob/main/README.md",
        "forks_count": 0,
        "avatar_url": None,
        "star_count": 0,
        "last_activity_at": "2025-07-06T18:53:00.513Z",
        "namespace": {
            "id": 105246917,
            "name": "Mykola Zabielin",
            "path": "SomeOneUnkn0wn",
            "kind": "user",
            "full_path": "SomeOneUnkn0wn",
            "parent_id": None,
            "avatar_url": "https://secure.gravatar.com/avatar/cb433e7bfdebc0d5fa0ad338774ad1e3d662aa79190edc714af55cae4e7c464b?s=80&d=identicon",
            "web_url": "https://gitlab.com/SomeOneUnkn0wn",
        },
        "visibility": "private",
        "permissions": {
            "project_access": {
                "access_level": 40,
                "notification_level": 3,
            },
            "group_access": None,
        },
    },
    {
        "id": 71408856,
        "description": None,
        "name": "Private Ac",
        "name_with_namespace": "Fred Kiss / Private Ac",
        "path": "private-ac",
        "path_with_namespace": "fredkiss3/private-ac",
        "created_at": "2025-07-06T18:52:53.253Z",
        "default_branch": "main",
        "tag_list": [],
        "topics": [],
        "ssh_url_to_repo": "git@gitlab.com:fredkiss3/private-ac.git",
        "http_url_to_repo": "https://gitlab.com/fredkiss3/private-ac.git",
        "web_url": "https://gitlab.com/fredkiss3/private-ac",
        "readme_url": "https://gitlab.com/fredkiss3/private-ac/-/blob/main/README.md",
        "forks_count": 0,
        "avatar_url": None,
        "visibility": "private",
        "star_count": 0,
        "last_activity_at": "2025-07-06T18:52:53.165Z",
        "namespace": {
            "id": 10493765,
            "name": "Fred Kiss",
            "path": "fredkiss3",
            "kind": "user",
            "full_path": "fredkiss3",
            "parent_id": None,
            "avatar_url": "https://secure.gravatar.com/avatar/9772ec11911021f7f3ae40e76789e67dd20b0f27e609d0e67d5479985c237169?s=80&d=identicon",
            "web_url": "https://gitlab.com/fredkiss3",
        },
        "permissions": {
            "project_access": {
                "access_level": 50,  # Owner
                "notification_level": 3,
            },
            "group_access": None,
        },
    },
]

GITLAB_PROJECT_WEBHOOK_API_DATA = {
    "id": 789542,
    "url": "http://127-0-0-1.sslip.io/api/connectors/gilab/webhook",
    "name": None,
    "description": None,
    "created_at": "2025-07-13T02:32:23.812Z",
    "push_events": True,
    "tag_push_events": False,
    "merge_requests_events": False,
    "repository_update_events": False,
    "enable_ssl_verification": True,
    "alert_status": "executable",
    "disabled_until": None,
    "url_variables": [],
    "push_events_branch_filter": None,
    "branch_filter_strategy": "wildcard",
    "custom_webhook_template": None,
    "custom_headers": [],
    "project_id": 15546,
    "issues_events": False,
    "confidential_issues_events": False,
    "note_events": False,
    "confidential_note_events": None,
    "pipeline_events": False,
    "wiki_page_events": False,
    "deployment_events": False,
    "feature_flag_events": False,
    "job_events": False,
    "releases_events": False,
    "milestone_events": False,
    "emoji_events": False,
    "resource_access_token_events": False,
    "vulnerability_events": False,
}

GITLAB_PUSH_WEBHOOK_EVENT_DATA = {
    "object_kind": "push",
    "event_name": "push",
    "before": "95790bf891e76fee5e1747ab589903a6a1f80f22",
    "after": "da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
    "ref": "refs/heads/main",
    "ref_protected": True,
    "checkout_sha": "da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
    "user_id": 4,
    "user_name": "John Smith",
    "user_username": "jsmith",
    "user_email": "john@gitlab.com",
    "user_avatar": "https://s.gravatar.com/avatar/d4c74594d841139328695756648b6bd6?s=8://s.gravatar.com/avatar/d4c74594d841139328695756648b6bd6?s=80",
    "project_id": 15,
    "project": {
        "id": 15,
        "name": "Diaspora",
        "description": "",
        "web_url": "https://gitlab.com/fredkiss3/private-ac",
        "avatar_url": None,
        "git_ssh_url": "git@gitlab.com:fredkiss3/private-ac.git",
        "git_http_url": "https://gitlab.com/fredkiss3/private-ac.git",
        "namespace": "Mike",
        "visibility_level": 0,
        "path_with_namespace": "fredkiss3/private-ac",
        "default_branch": "main",
        "homepage": "https://gitlab.com/fredkiss3/private-ac",
        "url": "git@gitlab.com:fredkiss3/private-ac.git",
        "ssh_url": "git@gitlab.com:fredkiss3/private-ac.git",
        "http_url": "https://gitlab.com/fredkiss3/private-ac.git",
    },
    "repository": {
        "name": "Diaspora",
        "url": "git@gitlab.com:fredkiss3/private-ac.git",
        "description": "",
        "homepage": "https://gitlab.com/fredkiss3/private-ac",
        "git_http_url": "https://gitlab.com/fredkiss3/private-ac.git",
        "git_ssh_url": "git@gitlab.com:fredkiss3/private-ac.git",
        "visibility_level": 0,
    },
    "commits": [
        {
            "id": "b6568db1bc1dcd7f8b4d5a946b0b91f9dacd7327",
            "message": "Update Catalan translation to e38cb41.\n\nSee https://gitlab.com/gitlab-org/gitlab for more information",
            "title": "Update Catalan translation to e38cb41.",
            "timestamp": "2011-12-12T14:27:31+02:00",
            "url": "https://gitlab.com/fredkiss3/private-ac/commit/b6568db1bc1dcd7f8b4d5a946b0b91f9dacd7327",
            "author": {"name": "Jordi Mallach", "email": "jordi@softcatala.org"},
            "added": ["CHANGELOG"],
            "modified": ["app/assets/index.js"],
            "removed": [],
        },
        {
            "id": "da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
            "message": "fixed readme",
            "title": "fixed readme",
            "timestamp": "2012-01-03T23:36:29+02:00",
            "url": "https://gitlab.com/fredkiss3/private-ac/commit/da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
            "author": {"name": "GitLab dev user", "email": "gitlabdev@dv6700.(none)"},
            "added": ["CHANGELOG"],
            "modified": ["app/controller/application.rb"],
            "removed": [],
        },
    ],
    "total_commits_count": 4,
}


GITLAB_MERGE_REQUEST_WEBHOOK_EVENT_DATA = {
    "object_kind": "merge_request",
    "event_type": "merge_request",
    "user": {
        "id": 1,
        "name": "Administrator",
        "username": "root",
        "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=40\u0026d=identicon",
        "email": "admin@example.com",
    },
    "project": {
        "id": 1,
        "name": "Gitlab Test",
        "description": "Aut reprehenderit ut est.",
        "web_url": "https://gitlab.com/fredkiss3/private-ac",
        "avatar_url": None,
        "git_ssh_url": "git@example.com:gitlabhq/gitlab-test.git",
        "git_http_url": "https://gitlab.com/fredkiss3/private-ac.git",
        "namespace": "GitlabHQ",
        "visibility_level": 20,
        "path_with_namespace": "gitlabhq/gitlab-test",
        "default_branch": "master",
        "ci_config_path": "",
        "homepage": "https://gitlab.com/fredkiss3/private-ac",
        "url": "https://gitlab.com/fredkiss3/private-ac.git",
        "ssh_url": "git@example.com:gitlabhq/gitlab-test.git",
        "http_url": "https://gitlab.com/fredkiss3/private-ac.git",
    },
    "repository": {
        "name": "Gitlab Test",
        "url": "https://gitlab.com/fredkiss3/private-ac.git",
        "description": "Aut reprehenderit ut est.",
        "homepage": "https://gitlab.com/fredkiss3/private-ac",
    },
    "object_attributes": {
        "id": 99,
        "iid": 1,
        "target_branch": "main",
        "source_branch": "feat/add-authentication",
        "source_project_id": 14,
        "author_id": 51,
        "assignee_ids": [6],
        "assignee_id": 6,
        "reviewer_ids": [6],
        "title": "Feat: add authentication",
        "created_at": "2013-12-03T17:23:34Z",
        "updated_at": "2013-12-03T17:23:34Z",
        "last_edited_at": "2013-12-03T17:23:34Z",
        "last_edited_by_id": 1,
        "milestone_id": None,
        "state_id": 1,
        "state": "opened",
        "blocking_discussions_resolved": True,
        "work_in_progress": False,
        "draft": False,
        "first_contribution": True,
        "merge_status": "unchecked",
        "target_project_id": 14,
        "description": "",
        "prepared_at": "2013-12-03T19:23:34Z",
        "total_time_spent": 1800,
        "time_change": 30,
        "human_total_time_spent": "30m",
        "human_time_change": "30s",
        "human_time_estimate": "30m",
        "url": "https://gitlab.com/fredkiss3/private-ac/-/merge_requests/2",
        "source": {
            "name": "Awesome Project",
            "description": "Aut reprehenderit ut est.",
            "web_url": "hhttps://gitlab.com/fredkiss3/private-act",
            "avatar_url": None,
            "git_ssh_url": "git@example.com:awesome_space/awesome_project.git",
            "git_http_url": "https://gitlab.com/fredkiss3/private-ac.git",
            "namespace": "Awesome Space",
            "visibility_level": 20,
            "path_with_namespace": "awesome_space/awesome_project",
            "default_branch": "master",
            "homepage": "https://gitlab.com/fredkiss3/private-ac",
            "url": "https://gitlab.com/fredkiss3/private-ac.git",
            "ssh_url": "git@example.com:awesome_space/awesome_project.git",
            "http_url": "https://gitlab.com/fredkiss3/private-ac.git",
        },
        "target": {
            "name": "Awesome Project",
            "description": "Aut reprehenderit ut est.",
            "web_url": "https://gitlab.com/fredkiss3/private-ac",
            "avatar_url": None,
            "git_ssh_url": "git@example.com:awesome_space/awesome_project.git",
            "git_http_url": "https://gitlab.com/fredkiss3/private-ac.git",
            "namespace": "Awesome Space",
            "visibility_level": 20,
            "path_with_namespace": "awesome_space/awesome_project",
            "default_branch": "master",
            "homepage": "https://gitlab.com/fredkiss3/private-ac",
            "url": "https://gitlab.com/fredkiss3/private-ac.git",
            "ssh_url": "git@example.com:awesome_space/awesome_project.git",
            "http_url": "https://gitlab.com/fredkiss3/private-ac.git",
        },
        "last_commit": {
            "id": "da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
            "message": "fixed readme",
            "title": "Update file README.md",
            "timestamp": "2012-01-03T23:36:29+02:00",
            "url": "https://gitlab.com/fredkiss3/private-ac/commits/da1560886d4f094c3e6c9ef40349f7d38b5d27d7",
            "author": {"name": "GitLab dev user", "email": "gitlabdev@dv6700.(none)"},
        },
        "labels": [
            {
                "id": 206,
                "title": "API",
                "color": "#ffffff",
                "project_id": 14,
                "created_at": "2013-12-03T17:15:43Z",
                "updated_at": "2013-12-03T17:15:43Z",
                "template": False,
                "description": "API related issues",
                "type": "ProjectLabel",
                "group_id": 41,
            }
        ],
        "action": "open",
        "detailed_merge_status": "mergeable",
    },
    "labels": [
        {
            "id": 206,
            "title": "API",
            "color": "#ffffff",
            "project_id": 14,
            "created_at": "2013-12-03T17:15:43Z",
            "updated_at": "2013-12-03T17:15:43Z",
            "template": False,
            "description": "API related issues",
            "type": "ProjectLabel",
            "group_id": 41,
        }
    ],
    "changes": {
        "updated_by_id": {"previous": None, "current": 1},
        "draft": {"previous": True, "current": False},
        "updated_at": {
            "previous": "2017-09-15 16:50:55 UTC",
            "current": "2017-09-15 16:52:00 UTC",
        },
        "labels": {
            "previous": [
                {
                    "id": 206,
                    "title": "API",
                    "color": "#ffffff",
                    "project_id": 14,
                    "created_at": "2013-12-03T17:15:43Z",
                    "updated_at": "2013-12-03T17:15:43Z",
                    "template": False,
                    "description": "API related issues",
                    "type": "ProjectLabel",
                    "group_id": 41,
                }
            ],
            "current": [
                {
                    "id": 205,
                    "title": "Platform",
                    "color": "#123123",
                    "project_id": 14,
                    "created_at": "2013-12-03T17:15:43Z",
                    "updated_at": "2013-12-03T17:15:43Z",
                    "template": False,
                    "description": "Platform related issues",
                    "type": "ProjectLabel",
                    "group_id": 41,
                }
            ],
        },
        "last_edited_at": {"previous": None, "current": "2023-03-15 00:00:10 UTC"},
        "last_edited_by_id": {"previous": None, "current": 3278533},
    },
    "assignees": [
        {
            "id": 6,
            "name": "User1",
            "username": "user1",
            "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=40\u0026d=identicon",
        }
    ],
    "reviewers": [
        {
            "id": 6,
            "name": "User1",
            "username": "user1",
            "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=40\u0026d=identicon",
        }
    ],
}


GITLAB_COMMENTS_DATA = {
    "id": 1,
    "body": "Comment for MR",
    "author": {
        "id": 1,
        "username": "pipin",
        "email": "admin@example.com",
        "name": "Pip",
        "state": "active",
        "created_at": "2013-09-30T13:46:01Z",
    },
    "created_at": "2013-10-02T08:57:14Z",
    "updated_at": "2013-10-02T08:57:14Z",
    "system": False,
    "noteable_id": 2,
    "noteable_type": "MergeRequest",
    "project_id": 5,
    "noteable_iid": 2,
    "resolvable": False,
    "confidential": False,
    "internal": False,
}


def mock_gitlab_notes_api():
    """
    Mock GitLab Notes API (merge_requests/{merge_request_iid}/notes).

    Supported endpoints:
      - POST /projects/{id}/merge_requests/{merge_request_iid}/notes
          -> creates a note (stored in-memory)
      - GET  /projects/{id}/merge_requests/{merge_request_iid}/notes/{note_id}
          -> returns the stored note if it exists, 404 otherwise
      - PUT  /projects/{id}/merge_requests/{merge_request_iid}/notes/{note_id}
          -> updates the body of the stored note, 404 otherwise

    NOTE: This mock only supports a single static note (id=1).
    The "body" field is dynamic based on request payload.
    """
    # In-memory store (only 1 note for simplicity)
    NOTE_STORE = {}

    gitlab_notes_api_pattern = re.compile(
        r"^https://gitlab\.com/api/v4/projects/[^/]+/merge_requests/\d+/notes/?$",
        re.IGNORECASE,
    )
    gitlab_single_note_pattern = re.compile(
        r"^https://gitlab\.com/api/v4/projects/[^/]+/merge_requests/\d+/notes/(\d+)/?$",
        re.IGNORECASE,
    )

    def post_note_callback(request):
        payload = json.loads(request.body.decode("utf-8"))
        body_text = payload.get("body", "")

        note_id = GITLAB_COMMENTS_DATA["id"]  # static id=1 for now
        NOTE_STORE[note_id] = {**GITLAB_COMMENTS_DATA, "body": body_text}
        return (status.HTTP_201_CREATED, {}, json.dumps(NOTE_STORE[note_id]))

    def get_note_callback(request):
        matched = gitlab_single_note_pattern.match(request.url)
        if not matched:
            return (
                status.HTTP_400_BAD_REQUEST,
                {},
                json.dumps({"message": "Bad Request"}),
            )

        note_id = int(matched.group(1))
        if note_id not in NOTE_STORE:
            return (status.HTTP_404_NOT_FOUND, {}, json.dumps({"message": "Not Found"}))

        return (status.HTTP_200_OK, {}, json.dumps(NOTE_STORE[note_id]))

    def put_note_callback(request):
        matched = gitlab_single_note_pattern.match(request.url)
        if not matched:
            return (
                status.HTTP_400_BAD_REQUEST,
                {},
                json.dumps({"message": "Bad Request"}),
            )

        note_id = int(matched.group(1))
        if note_id not in NOTE_STORE:
            return (status.HTTP_404_NOT_FOUND, {}, json.dumps({"message": "Not Found"}))

        payload = json.loads(request.body.decode("utf-8"))
        new_body = payload.get("body", NOTE_STORE[note_id]["body"])
        NOTE_STORE[note_id]["body"] = new_body
        return (status.HTTP_200_OK, {}, json.dumps(NOTE_STORE[note_id]))

    # Register the mocks
    responses.add_callback(
        responses.POST,
        gitlab_notes_api_pattern,
        callback=post_note_callback,
        content_type="application/json",
    )

    responses.add_callback(
        responses.GET,
        gitlab_single_note_pattern,
        callback=get_note_callback,
        content_type="application/json",
    )

    responses.add_callback(
        responses.PUT,  # GitLab uses PUT for updating notes
        gitlab_single_note_pattern,
        callback=put_note_callback,
        content_type="application/json",
    )

    return NOTE_STORE
